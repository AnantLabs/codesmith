
'------------------------------------------------------------------------------
' <autogenerated>
'     This code was generated by a CodeSmith Template.
'
'     DO NOT MODIFY contents of this file. Changes to this
'     file will be lost if the code is regenerated.
' </autogenerated>
'------------------------------------------------------------------------------

Imports System
Imports System.Collections.Generic
Imports System.Data.Linq
Imports System.Data.SqlTypes
Imports System.Linq
Imports System.Text
Imports CodeSmith.Data
Imports CodeSmith.Data.Rules
Imports CodeSmith.Data.Rules.Assign
Imports CodeSmith.Data.Rules.Validation
Imports Petshop.Data

Namespace Petshop.Data.Managers
    ''' <summary>
    ''' The manager class for Item.
    ''' </summary>
    Partial Public Class ItemManager 
	Inherits EntityManagerBase(Of PetshopDataManager,Item)
        ''' <summary>
        ''' Initializes the <see cref="ItemManager"/> class.
        ''' </summary>
        Shared Sub New()
            RuleManager.AddShared(Of Item)(new RequiredRule("ItemId"))
            RuleManager.AddShared(Of Item)(new LengthRule("ItemId", 10))
            RuleManager.AddShared(Of Item)(new RequiredRule("ProductId"))
            RuleManager.AddShared(Of Item)(new LengthRule("ProductId", 10))
            RuleManager.AddShared(Of Item)(new LengthRule("Status", 2))
            RuleManager.AddShared(Of Item)(new LengthRule("Name", 80))
            RuleManager.AddShared(Of Item)(new LengthRule("Image", 80))
            AddRules()
        End Sub

        ''' <summary>
        ''' Initializes the <see cref="ItemManager"/> class.
        ''' </summary>
        ''' <param name="manager">The current manager.</param>
        Public Sub New(ByVal manager As PetshopDataManager) 
			MyBase.New(manager)
            OnCreated()
        End Sub

        ''' <summary>
        ''' Gets the current context.
        ''' </summary>
        Protected ReadOnly Property Context As PetshopDataContext
            Get
				return Manager.Context
			End Get
        End Property
        
        ''' <summary>
        ''' Gets the entity for this manager.
        ''' </summary>
        Protected ReadOnly Property Entity As Table(Of Item)
            Get 
				return Manager.Context.Item
			End Get
        End Property
        
        
        ''' <summary>
        ''' Creates the key for this entity.
        ''' </summary>
        Public Shared Function CreateKey(itemId As String) As IEntityKey(Of String)
            Return New EntityKey(Of String)(itemId)
        End Function
        
        ''' <summary>
        ''' Gets an entity by the primary key.
        ''' </summary>
        ''' <param name="key">The key for the entity.</param>
        ''' <returns>
        ''' An instance of the entity or null if not found.
        ''' </returns>
        ''' <remarks>
        ''' This method is expecting key to be of type IEntityKey(Of String).
        ''' </remarks>
        ''' <exception cref="ArgumentException">Thrown when key is not of type IEntityKey(Of String).</exception>
        Public Overrides Function GetByKey(ByVal key As IEntityKey) As Item
            If (key Is GetType(IEntityKey(Of String))) Then
                Dim entityKey As IEntityKey(Of String) = DirectCast(key,IEntityKey(Of String))
                return GetByKey(entityKey.Key)
            Else
                Throw New ArgumentException("Invalid key, expected key to be of type IEntityKey(Of String)")
            End If
        End Function
        
        ''' <summary>
        ''' Gets an instance by the primary key.
        ''' </summary>
        ''' <returns>An instance of the entity or null if not found.</returns>
        Public Overloads Function GetByKey(itemId As String) As Item
            If (Context.LoadOptions Is Nothing) Then 
                return Query.GetByKey.Invoke(Context, itemId)
            Else
                return Entity.FirstOrDefault(Function(i)i.ItemId = itemId)
			End If
        End Function
        ''' <summary>
        ''' Gets a query by an index.
        ''' </summary>
        Public Overloads Function GetByProductIdItemIdListPriceName(productId As String, itemId As String, listPrice As Decimal?, [Name] As String) As IQueryable(Of Item)
                return Entity.Where(Function(i)i.ProductId = productId _
					AndAlso i.ItemId = itemId _
					AndAlso i.ListPrice = listPrice _
					AndAlso i.Name = [Name])
        End Function
        ''' <summary>
        ''' Gets a query by an index.
        ''' </summary>
        Public Overloads Function GetByProductId(productId As String) As IQueryable(Of Item)
            If Context.LoadOptions Is Nothing Then 
                return Query.GetByProductId.Invoke(Context, productId)
            Else
                return Entity.Where(Function(i)i.ProductId = productId)
			End If
        End Function
        ''' <summary>
        ''' Gets a query by an index.
        ''' </summary>
        Public Overloads Function GetBySupplier(supplier As Integer?) As IQueryable(Of Item)
            If Context.LoadOptions Is Nothing Then 
                return Query.GetBySupplier.Invoke(Context, supplier)
            Else
                return Entity.Where(Function(i)i.Supplier = supplier)
			End If
        End Function

        #Region "Extensibility Method Definitions"
        ''' <summary>Called by the static constructor to add shared rules.</summary>
        Shared Partial Private Sub AddRules()
		End Sub
        ''' <summary>Called when the class is created.</summary>
        Partial Private Sub OnCreated()
		End Sub
        #End Region
        
        #Region "Query"
        ''' <summary>
        ''' A private class for lazy loading static compiled queries.
        ''' </summary>
        Private Partial Class Query

            Friend Shared Readonly GetByKey As Func(Of PetshopDataContext, String, Item) = _
                CompiledQuery.Compile( _
                     Function(db As PetshopDataContext, itemId As String) _
                        db.Item.FirstOrDefault(Function(i)i.ItemId = itemId))

            Friend Shared Readonly  GetByProductId As Func(Of PetshopDataContext, String, IQueryable(Of Item)) = _
                CompiledQuery.Compile( _
                    Function( db As PetshopDataContext , productId As String) _
                        db.Item.Where(Function(i)i.ProductId = productId))

            Friend Shared Readonly  GetBySupplier As Func(Of PetshopDataContext, Integer?, IQueryable(Of Item)) = _
                CompiledQuery.Compile( _
                    Function( db As PetshopDataContext , supplier As Integer?) _
                        db.Item.Where(Function(i)i.Supplier = supplier))

        End Class
        #End Region
    End Class
End Namespace

