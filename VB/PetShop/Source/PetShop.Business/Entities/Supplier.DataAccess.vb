
'------------------------------------------------------------------------------
' <autogenerated>
'     Me code was generated Imports CSLA 3.7.X CodeSmith Templates.
'     Changes to Me file will be lost after each regeneration.
'     To extend the functionality of Me class, please modify the partial class 'Supplier.vb.
'
'     Template: EditableRoot.DataAccess.cst
'     Template website: http://code.google.com/p/codesmith/
' </autogenerated>
'------------------------------------------------------------------------------
Option Explicit On
Option Strict On

Imports System

Imports Csla
Imports Csla.Data
Imports Csla.Validation

Imports PetShop.Data

Public Partial Class Supplier
		
	#Region "Data Access"

	<RunLocal()> _
	Protected Shadows Sub DataPortal_Create()
		'MyBase.DataPortal_Create()

		ValidationRules.CheckRules()
	End Sub

	Private Shadows Sub DataPortal_Fetch(ByVal criteria As SupplierCriteria)
	    Using reader As SafeDataReader = DataAccessLayer.Instance.SupplierFetch(criteria.StateBag)
            If reader.Read() Then
	            Fetch(reader)
            End If
        End Using
    End Sub
	
    Private Sub Fetch(ByVal reader As SafeDataReader)
		LoadProperty(_suppIdProperty, reader.GetInt32("SuppId"))
		LoadProperty(_nameProperty, reader.GetString("Name"))
		LoadProperty(_statusProperty, reader.GetString("Status"))
		LoadProperty(_addr1Property, reader.GetString("Addr1"))
		LoadProperty(_addr2Property, reader.GetString("Addr2"))
		LoadProperty(_cityProperty, reader.GetString("City"))
		LoadProperty(_stateProperty, reader.GetString("State"))
		LoadProperty(_zipProperty, reader.GetString("Zip"))
		LoadProperty(_phoneProperty, reader.GetString("Phone"))


        MarkOld()
    End Sub
	
	<Transactional(TransactionalTypes.TransactionScope)> _
	Protected Overrides Sub DataPortal_Insert()
		Using reader As SafeDataReader = DataAccessLayer.Instance.SupplierInsert(ReadProperty(_suppIdProperty), ReadProperty(_nameProperty), ReadProperty(_statusProperty), ReadProperty(_addr1Property), ReadProperty(_addr2Property), ReadProperty(_cityProperty), ReadProperty(_stateProperty), ReadProperty(_zipProperty), ReadProperty(_phoneProperty))
			If reader.Read() Then

			End If
		End Using
        
        FieldManager.UpdateChildren(Me)
	End Sub
	
	<Transactional(TransactionalTypes.TransactionScope)> _
	Protected Overrides Sub DataPortal_Update()
        Using reader As SafeDataReader = DataAccessLayer.Instance.SupplierUpdate(ReadProperty(_suppIdProperty), ReadProperty(_nameProperty), ReadProperty(_statusProperty), ReadProperty(_addr1Property), ReadProperty(_addr2Property), ReadProperty(_cityProperty), ReadProperty(_stateProperty), ReadProperty(_zipProperty), ReadProperty(_phoneProperty))
        End Using
        
        FieldManager.UpdateChildren(Me)
	End Sub
	
	<Transactional(TransactionalTypes.TransactionScope)> _
	Protected Overrides Sub DataPortal_DeleteSelf()
        DataPortal_Delete(new SupplierCriteria(SuppId))
    End Sub
	
	<Transactional(TransactionalTypes.TransactionScope)> _
	Protected Overrides Sub DataPortal_Delete(ByVal criteria As Object)
		Dim theCriteria As SupplierCriteria = DirectCast(criteria, SupplierCriteria)
        If Not theCriteria Is Nothing Then
			Using reader As SafeDataReader = DataAccessLayer.Instance.SupplierDelete(theCriteria.StateBag)
			End Using
		End If
    End Sub

    #End Region
End Class