'------------------------------------------------------------------------------
' <autogenerated>
'     This code was generated Imports CSLA 3.7.X CodeSmith Templates.
'     Changes to this file will be lost after each regeneration.
'     To extend the functionality of this class, please modify the partial class 'Category.vb.
'
'     Template path: EditableRoot.Generated.cst
'     Template website: http://code.google.com/p/codesmith/
' </autogenerated>
'------------------------------------------------------------------------------
Option Explicit On
Option Strict On

Imports System

Imports Csla
Imports Csla.Data
Imports Csla.Validation

<Serializable()> _
Public Partial Class Category 
    Inherits BusinessBase(Of Category)

    #Region "Contructor(s)"

	Private Sub New()
    	' require use of factory method 
End Sub
    
    Friend Sub New(Byval reader As SafeDataReader)
        Fetch(reader)
	End Sub
    
	#End Region
    
	#Region "Validation Rules"
	
	Protected Overrides Sub AddBusinessRules()
	
        If AddBusinessValidationRules() Then Exit Sub
       
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_nameProperty, 80))
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_descnProperty, 255))
		ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _categoryIdProperty)
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_categoryIdProperty, 10))
	End Sub
	
	#End Region
	
	#Region "Business Methods"


	
	Private Shared ReadOnly _categoryIdProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Category) p.CategoryId)
		<System.ComponentModel.DataObjectField(true, false)> _
	Public Property CategoryId() As String
		Get 
			Return GetProperty(_categoryIdProperty)
		End Get
        Set (ByVal value As String)
            OnPropertyChanging("CategoryId")
            SetProperty(_categoryIdProperty, value)
            OnPropertyChanged("CategoryId")
        End Set
	End Property
	
	
	Private Shared ReadOnly _nameProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Category) p.Name)
	Public Property Name() As String
		Get 
			Return GetProperty(_nameProperty)
		End Get
        Set (ByVal value As String)
            OnPropertyChanging("Name")
            SetProperty(_nameProperty, value)
            OnPropertyChanged("Name")
        End Set
	End Property
	
	
	Private Shared ReadOnly _descnProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Category) p.Descn)
	Public Property Descn() As String
		Get 
			Return GetProperty(_descnProperty)
		End Get
        Set (ByVal value As String)
            OnPropertyChanging("Descn")
            SetProperty(_descnProperty, value)
            OnPropertyChanged("Descn")
        End Set
	End Property
	
	Private Shared ReadOnly _productsProperty As PropertyInfo(Of ProductList) = RegisterProperty(Of ProductList)(Function(p As Category) p.Products, Csla.RelationshipTypes.LazyLoad)
	Public ReadOnly Property Products() As ProductList 
		Get
            If Not (FieldManager.FieldExists(_productsProperty)) Then
                SetProperty(_productsProperty, ProductList.GetByCategoryId(CategoryId))

            End If
            Return GetProperty(_productsProperty) 
        End Get
    End Property
    
	#End Region
	
	#Region "Factory Methods"
	
	Public Shared Function NewCategory() As Category 
		Return DataPortal.Create(Of Category)()
	End Function
	
	Public Shared Function GetCategory(ByVal categoryId As String) As Category 		
		Return DataPortal.Fetch(Of Category)(New CategoryCriteria(categoryId))
	End Function

    Public Shared Sub DeleteCategory(ByVal categoryId As String)
	    DataPortal.Delete(New CategoryCriteria(categoryId))
	End Sub

    #End Region
    

End Class
