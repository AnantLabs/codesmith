'------------------------------------------------------------------------------
' <autogenerated>
'     This code was generated Imports CSLA 3.7.X CodeSmith Templates.
'     Changes to this file will be lost after each regeneration.
'     To extend the functionality of this class, please modify the partial class 'Product.vb.
'
'     Template: DynamicRootList.Generated.cst
'     Template website: http://code.google.com/p/codesmith/
' </autogenerated>
'------------------------------------------------------------------------------
Option Explicit On
Option Strict On

Imports System

Imports Csla

<Serializable()> _
Public Partial Class ProductList 
    Inherits EditableRootListBase(Of Product)
    
	#Region "Business Methods"
	
	Protected Overrides Function AddNewCore() As Object
	    Dim item As Product = PetShop.Business.Product.NewProduct()
        Me.Add(item)
        Return item
	End Function
	
	#End Region

	#Region "Factory Methods"
	
	Public Shared Function NewList() As ProductList
		Return DataPortal.Create(Of ProductList)()
	End Function
	
	Public Shared Function GetProductList(ByVal productId As String) As ProductList
		Return DataPortal.Fetch(Of ProductList)(new ProductCriteria(productId))
	End Function
    
    Public Shared Function GetAll() As ProductList
        Return DataPortal.Fetch(Of ProductList)(new ProductCriteria())
    End Function
    
    Public Shared Function GetByCategoryId(ByVal categoryId As String) As ProductList
        Dim criteria As New ProductCriteria()
        criteria.CategoryId = categoryId
        
        Return DataPortal.Fetch(Of ProductList)(criteria)
    End Function
    
    Private Sub New()
	    AllowNew = true
	End Sub
	
	#End Region

End Class