'------------------------------------------------------------------------------
' <autogenerated>
'     This code was generated Imports CSLA 3.7.X CodeSmith Templates.
'     Changes to this file will be lost after each regeneration.
'     To extend the functionality of this class, please modify the partial class 'Account.vb.
'
'     Template: EditableChild.Generated.cst
'     Template website: http://code.google.com/p/codesmith/
' </autogenerated>
'------------------------------------------------------------------------------
Option Explicit On
Option Strict On

Imports System

Imports Csla
Imports Csla.Data
Imports Csla.Validation

<Serializable()> _
Public Partial Class Account 
    Inherits BusinessBase(Of Account)

    #Region "Contructor(s)"

	Private Sub New()
    	' require use of factory method 
End Sub
    
    Friend Sub New(Byval reader As SafeDataReader)
        Fetch(reader)
	End Sub
    
	#End Region
    
	#Region "Validation Rules"
	
	Protected Overrides Sub AddBusinessRules()
	
        If AddBusinessValidationRules() Then Exit Sub
       
		ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _emailProperty)
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_emailProperty, 80))
		ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _firstNameProperty)
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_firstNameProperty, 80))
		ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _lastNameProperty)
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_lastNameProperty, 80))
		ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _address1Property)
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_address1Property, 80))
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_address2Property, 80))
		ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _cityProperty)
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_cityProperty, 80))
		ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _stateProperty)
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_stateProperty, 80))
		ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _zipProperty)
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_zipProperty, 20))
		ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _countryProperty)
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_countryProperty, 20))
		ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_phoneProperty, 20))
	End Sub
	
	#End Region
    
    #Region "Business Methods"


	
	Private Shared ReadOnly _accountIdProperty As PropertyInfo(Of Integer) = RegisterProperty(Of Integer)(Function(p As Account) p.AccountId)
		<System.ComponentModel.DataObjectField(true, true)> _
	Public ReadOnly Property AccountId() As Integer
		Get 
			Return GetProperty(_accountIdProperty)
		End Get
	End Property
	
	
	Private Shared ReadOnly _emailProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.Email)
	Public Property Email() As String
		Get 
			Return GetProperty(_emailProperty)
		End Get
        Set (ByVal value As String)
            SetProperty(_emailProperty, value)
        End Set
	End Property
	
	
	Private Shared ReadOnly _firstNameProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.FirstName)
	Public Property FirstName() As String
		Get 
			Return GetProperty(_firstNameProperty)
		End Get
        Set (ByVal value As String)
            SetProperty(_firstNameProperty, value)
        End Set
	End Property
	
	
	Private Shared ReadOnly _lastNameProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.LastName)
	Public Property LastName() As String
		Get 
			Return GetProperty(_lastNameProperty)
		End Get
        Set (ByVal value As String)
            SetProperty(_lastNameProperty, value)
        End Set
	End Property
	
	
	Private Shared ReadOnly _address1Property As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.Address1)
	Public Property Address1() As String
		Get 
			Return GetProperty(_address1Property)
		End Get
        Set (ByVal value As String)
            SetProperty(_address1Property, value)
        End Set
	End Property
	
	
	Private Shared ReadOnly _address2Property As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.Address2)
	Public Property Address2() As String
		Get 
			Return GetProperty(_address2Property)
		End Get
        Set (ByVal value As String)
            SetProperty(_address2Property, value)
        End Set
	End Property
	
	
	Private Shared ReadOnly _cityProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.City)
	Public Property City() As String
		Get 
			Return GetProperty(_cityProperty)
		End Get
        Set (ByVal value As String)
            SetProperty(_cityProperty, value)
        End Set
	End Property
	
	
	Private Shared ReadOnly _stateProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.State)
	Public Property State() As String
		Get 
			Return GetProperty(_stateProperty)
		End Get
        Set (ByVal value As String)
            SetProperty(_stateProperty, value)
        End Set
	End Property
	
	
	Private Shared ReadOnly _zipProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.Zip)
	Public Property Zip() As String
		Get 
			Return GetProperty(_zipProperty)
		End Get
        Set (ByVal value As String)
            SetProperty(_zipProperty, value)
        End Set
	End Property
	
	
	Private Shared ReadOnly _countryProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.Country)
	Public Property Country() As String
		Get 
			Return GetProperty(_countryProperty)
		End Get
        Set (ByVal value As String)
            SetProperty(_countryProperty, value)
        End Set
	End Property
	
	
	Private Shared ReadOnly _phoneProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Account) p.Phone)
	Public Property Phone() As String
		Get 
			Return GetProperty(_phoneProperty)
		End Get
        Set (ByVal value As String)
            SetProperty(_phoneProperty, value)
        End Set
	End Property
	
    Private Shared _uniqueIDProperty As PropertyInfo(Of Integer) = RegisterProperty(Of Integer)(Function(p As Account) p.UniqueID)
	Public Property UniqueID() As Integer 
		Get  
			Return GetProperty(_uniqueIDProperty)				
		End Get
        Set (ByVal value As Integer)
            SetProperty(_uniqueIDProperty, value) 
        End Set
	End Property
	
	Private Shared ReadOnly _profileProperty As PropertyInfo(Of Profile) = RegisterProperty(Of Profile)(Function(p As Account) p.Profile, Csla.RelationshipTypes.LazyLoad)
	Public ReadOnly Property Profile() As Profile
		Get
        
            If Not(FieldManager.FieldExists(_profileProperty))
                SetProperty(_profileProperty, Profile.GetProfile(UniqueID))
            End If
            
            Return GetProperty(_profileProperty) 
        End Get
    End Property
    
' NOTE: Many-To-Many support coming soon.
	#End Region
			
	#Region "Factory Methods"
	
	Friend Shared Function NewAccount() As Account 
		Return DataPortal.Create(Of Account)()
	End Function
	
	Friend Shared Function GetAccount(ByVal accountId As Integer) As Account 		
		Return DataPortal.Fetch(Of Account)(New AccountCriteria(accountId))
	End Function
	
	#End Region
	

End Class
