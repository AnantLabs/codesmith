'------------------------------------------------------------------------------
' <autogenerated>
'     This code was generated Imports CSLA 3.7.X CodeSmith Templates.
'     Changes to this file will be lost after each regeneration.
'     To extend the functionality of this class, please modify the partial class 'Order.vb.
'
'     Template: SwitchableObject.DataAccess.cst
'     Template website: http://code.google.com/p/codesmith/
' </autogenerated>
'------------------------------------------------------------------------------
Option Explicit On
Option Strict On

Imports System

Imports Csla
Imports Csla.Data

Imports PetShop.Data

Public Partial Class Order
	
    #Region "Root Data Access"
	
	<RunLocal()> _
	Protected Overrides Sub DataPortal_Create()
		'MyBase.DataPortal_Create()

		ValidationRules.CheckRules()
	End Sub
	
    <Transactional(TransactionalTypes.TransactionScope)> _
	Private Shadows Sub DataPortal_Fetch(ByVal criteria As OrderCriteria)
	    Using reader As SafeDataReader = DataAccessLayer.Instance.OrderFetch(criteria.StateBag)
            If reader.Read() Then
	            Fetch(reader)
            End If
        End Using
    End Sub
	
	<Transactional(TransactionalTypes.TransactionScope)> _
	Protected Overrides Sub DataPortal_Insert()
		Using reader As SafeDataReader = DataAccessLayer.Instance.OrderInsert(ReadProperty(_userIdProperty), ReadProperty(_orderDateProperty), ReadProperty(_shipAddr1Property), ReadProperty(_shipAddr2Property), ReadProperty(_shipCityProperty), ReadProperty(_shipStateProperty), ReadProperty(_shipZipProperty), ReadProperty(_shipCountryProperty), ReadProperty(_billAddr1Property), ReadProperty(_billAddr2Property), ReadProperty(_billCityProperty), ReadProperty(_billStateProperty), ReadProperty(_billZipProperty), ReadProperty(_billCountryProperty), ReadProperty(_courierProperty), ReadProperty(_totalPriceProperty), ReadProperty(_billToFirstNameProperty), ReadProperty(_billToLastNameProperty), ReadProperty(_shipToFirstNameProperty), ReadProperty(_shipToLastNameProperty), ReadProperty(_authorizationNumberProperty), ReadProperty(_localeProperty))
			If reader.Read() Then

				LoadProperty(_orderIdProperty, reader.GetInt32("OrderId"))
			End If
		End Using
        
	End Sub
	
	<Transactional(TransactionalTypes.TransactionScope)> _
	Protected Overrides Sub DataPortal_Update()
        Using reader As SafeDataReader = DataAccessLayer.Instance.OrderUpdate(ReadProperty(_orderIdProperty), ReadProperty(_userIdProperty), ReadProperty(_orderDateProperty), ReadProperty(_shipAddr1Property), ReadProperty(_shipAddr2Property), ReadProperty(_shipCityProperty), ReadProperty(_shipStateProperty), ReadProperty(_shipZipProperty), ReadProperty(_shipCountryProperty), ReadProperty(_billAddr1Property), ReadProperty(_billAddr2Property), ReadProperty(_billCityProperty), ReadProperty(_billStateProperty), ReadProperty(_billZipProperty), ReadProperty(_billCountryProperty), ReadProperty(_courierProperty), ReadProperty(_totalPriceProperty), ReadProperty(_billToFirstNameProperty), ReadProperty(_billToLastNameProperty), ReadProperty(_shipToFirstNameProperty), ReadProperty(_shipToLastNameProperty), ReadProperty(_authorizationNumberProperty), ReadProperty(_localeProperty))
        End Using
        
	End Sub
	
	<Transactional(TransactionalTypes.TransactionScope)> _
	Protected Overrides Sub DataPortal_DeleteSelf()
        DataPortal_Delete(new OrderCriteria(OrderId))
    End Sub
	
	<Transactional(TransactionalTypes.TransactionScope)> _
	Protected Overrides Sub DataPortal_Delete(ByVal criteria As Object)
		Dim theCriteria As OrderCriteria = DirectCast(criteria, OrderCriteria)
        If Not theCriteria Is Nothing Then
			Using reader As SafeDataReader = DataAccessLayer.Instance.OrderDelete(theCriteria.StateBag)
			End Using
		End If
    End Sub


	#End Region
	
	#Region "Child Data Access"

	<RunLocal()> _
    Protected Overrides Sub Child_Create()
		' TODO: load default values
		' omit this override if you have no defaults to set
		'MyBase.Child_Create()
    End Sub
	
	Private Sub Child_Fetch(ByVal criteria As Object)
		Dim theCriteria As OrderCriteria = DirectCast(criteria, OrderCriteria)
        If Not theCriteria Is Nothing Then
			Using reader As SafeDataReader = DataAccessLayer.Instance.OrderFetch(theCriteria.StateBag)
				If reader.Read() Then
					Fetch(reader)
				End If
			End Using
		End If
        
        MarkAsChild()
	End Sub
	
	Private Sub Child_Insert()
	    Using reader As SafeDataReader = DataAccessLayer.Instance.OrderInsert(ReadProperty(_userIdProperty), ReadProperty(_orderDateProperty), ReadProperty(_shipAddr1Property), ReadProperty(_shipAddr2Property), ReadProperty(_shipCityProperty), ReadProperty(_shipStateProperty), ReadProperty(_shipZipProperty), ReadProperty(_shipCountryProperty), ReadProperty(_billAddr1Property), ReadProperty(_billAddr2Property), ReadProperty(_billCityProperty), ReadProperty(_billStateProperty), ReadProperty(_billZipProperty), ReadProperty(_billCountryProperty), ReadProperty(_courierProperty), ReadProperty(_totalPriceProperty), ReadProperty(_billToFirstNameProperty), ReadProperty(_billToLastNameProperty), ReadProperty(_shipToFirstNameProperty), ReadProperty(_shipToLastNameProperty), ReadProperty(_authorizationNumberProperty), ReadProperty(_localeProperty))
			If reader.Read() Then

				LoadProperty(_orderIdProperty, reader.GetInt32("OrderId"))
			End If
		End Using
	End Sub
	
	Private Sub Child_Update()
        Using reader As SafeDataReader = DataAccessLayer.Instance.OrderUpdate(ReadProperty(_orderIdProperty), ReadProperty(_userIdProperty), ReadProperty(_orderDateProperty), ReadProperty(_shipAddr1Property), ReadProperty(_shipAddr2Property), ReadProperty(_shipCityProperty), ReadProperty(_shipStateProperty), ReadProperty(_shipZipProperty), ReadProperty(_shipCountryProperty), ReadProperty(_billAddr1Property), ReadProperty(_billAddr2Property), ReadProperty(_billCityProperty), ReadProperty(_billStateProperty), ReadProperty(_billZipProperty), ReadProperty(_billCountryProperty), ReadProperty(_courierProperty), ReadProperty(_totalPriceProperty), ReadProperty(_billToFirstNameProperty), ReadProperty(_billToLastNameProperty), ReadProperty(_shipToFirstNameProperty), ReadProperty(_shipToLastNameProperty), ReadProperty(_authorizationNumberProperty), ReadProperty(_localeProperty))
        End Using
	End Sub
	
	Private Sub Child_DeleteSelf()
        DataPortal_Delete(new OrderCriteria(OrderId))
    End Sub

	#End Region

    Private Sub Fetch(ByVal reader As SafeDataReader)
		LoadProperty(_orderIdProperty, reader.GetInt32("OrderId"))
		LoadProperty(_userIdProperty, reader.GetString("UserId"))
		LoadProperty(_orderDateProperty, reader.GetDateTime("OrderDate"))
		LoadProperty(_shipAddr1Property, reader.GetString("ShipAddr1"))
		LoadProperty(_shipAddr2Property, reader.GetString("ShipAddr2"))
		LoadProperty(_shipCityProperty, reader.GetString("ShipCity"))
		LoadProperty(_shipStateProperty, reader.GetString("ShipState"))
		LoadProperty(_shipZipProperty, reader.GetString("ShipZip"))
		LoadProperty(_shipCountryProperty, reader.GetString("ShipCountry"))
		LoadProperty(_billAddr1Property, reader.GetString("BillAddr1"))
		LoadProperty(_billAddr2Property, reader.GetString("BillAddr2"))
		LoadProperty(_billCityProperty, reader.GetString("BillCity"))
		LoadProperty(_billStateProperty, reader.GetString("BillState"))
		LoadProperty(_billZipProperty, reader.GetString("BillZip"))
		LoadProperty(_billCountryProperty, reader.GetString("BillCountry"))
		LoadProperty(_courierProperty, reader.GetString("Courier"))
		LoadProperty(_totalPriceProperty, reader.GetDecimal("TotalPrice"))
		LoadProperty(_billToFirstNameProperty, reader.GetString("BillToFirstName"))
		LoadProperty(_billToLastNameProperty, reader.GetString("BillToLastName"))
		LoadProperty(_shipToFirstNameProperty, reader.GetString("ShipToFirstName"))
		LoadProperty(_shipToLastNameProperty, reader.GetString("ShipToLastName"))
		LoadProperty(_authorizationNumberProperty, reader.GetInt32("AuthorizationNumber"))
		LoadProperty(_localeProperty, reader.GetString("Locale"))


        MarkOld()
    End Sub
    
End Class