'------------------------------------------------------------------------------
' <autogenerated>
'     This code was generated Imports CSLA 3.8.X CodeSmith Templates.
'     Changes to this file will be lost after each regeneration.
'     To extend the functionality of this class, please modify the partial class 'Order.vb.
'
'     Template: SwitchableObject.Generated.cst
'     Template website: http://code.google.com/p/codesmith/
' </autogenerated>
'------------------------------------------------------------------------------
Option Explicit On
Option Strict On

Imports System

Imports Csla
Imports Csla.Data
Imports Csla.Validation

<Serializable()> _
Public Partial Class Order 
    Inherits BusinessBase(Of Order)
    
    #Region "Contructor(s)"

    Private Sub New()
        ' require use of factory method 
    End Sub

    Friend Sub New(Byval reader As SafeDataReader)
        Map(reader)
    End Sub

    #End Region
    
    #Region "Validation Rules"
    
    Protected Overrides Sub AddBusinessRules()
    
        If AddBusinessValidationRules() Then Exit Sub
       
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _userIdProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_userIdProperty, 20))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _shipAddr1Property)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_shipAddr1Property, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_shipAddr2Property, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _shipCityProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_shipCityProperty, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _shipStateProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_shipStateProperty, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _shipZipProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_shipZipProperty, 20))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _shipCountryProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_shipCountryProperty, 20))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _billAddr1Property)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_billAddr1Property, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_billAddr2Property, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _billCityProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_billCityProperty, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _billStateProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_billStateProperty, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _billZipProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_billZipProperty, 20))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _billCountryProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_billCountryProperty, 20))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _courierProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_courierProperty, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _billToFirstNameProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_billToFirstNameProperty, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _billToLastNameProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_billToLastNameProperty, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _shipToFirstNameProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_shipToFirstNameProperty, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _shipToLastNameProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_shipToLastNameProperty, 80))
        ValidationRules.AddRule(AddressOf CommonRules.StringRequired, _localeProperty)
        ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs(_localeProperty, 20))
    End Sub
    
    #End Region
    
    #Region "Business Methods"


    
    Private Shared ReadOnly _orderIdProperty As PropertyInfo(Of Integer) = RegisterProperty(Of Integer)(Function(p As Order) p.OrderId)
		<System.ComponentModel.DataObjectField(true, true)> _
    Public ReadOnly Property OrderId() As Integer
        Get 
            Return GetProperty(_orderIdProperty)
        End Get
    End Property
    
    
    Private Shared ReadOnly _userIdProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.UserId)
    Public Property UserId() As String
        Get 
            Return GetProperty(_userIdProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_userIdProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _orderDateProperty As PropertyInfo(Of SmartDate) = RegisterProperty(Of SmartDate)(Function(p As Order) p.OrderDate)
    Public Property OrderDate() As SmartDate
        Get 
            Return GetProperty(_orderDateProperty)
        End Get
        Set (ByVal value As SmartDate)
            SetProperty(_orderDateProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _shipAddr1Property As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.ShipAddr1)
    Public Property ShipAddr1() As String
        Get 
            Return GetProperty(_shipAddr1Property)
        End Get
        Set (ByVal value As String)
            SetProperty(_shipAddr1Property, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _shipAddr2Property As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.ShipAddr2)
    Public Property ShipAddr2() As String
        Get 
            Return GetProperty(_shipAddr2Property)
        End Get
        Set (ByVal value As String)
            SetProperty(_shipAddr2Property, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _shipCityProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.ShipCity)
    Public Property ShipCity() As String
        Get 
            Return GetProperty(_shipCityProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_shipCityProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _shipStateProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.ShipState)
    Public Property ShipState() As String
        Get 
            Return GetProperty(_shipStateProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_shipStateProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _shipZipProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.ShipZip)
    Public Property ShipZip() As String
        Get 
            Return GetProperty(_shipZipProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_shipZipProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _shipCountryProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.ShipCountry)
    Public Property ShipCountry() As String
        Get 
            Return GetProperty(_shipCountryProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_shipCountryProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _billAddr1Property As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.BillAddr1)
    Public Property BillAddr1() As String
        Get 
            Return GetProperty(_billAddr1Property)
        End Get
        Set (ByVal value As String)
            SetProperty(_billAddr1Property, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _billAddr2Property As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.BillAddr2)
    Public Property BillAddr2() As String
        Get 
            Return GetProperty(_billAddr2Property)
        End Get
        Set (ByVal value As String)
            SetProperty(_billAddr2Property, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _billCityProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.BillCity)
    Public Property BillCity() As String
        Get 
            Return GetProperty(_billCityProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_billCityProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _billStateProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.BillState)
    Public Property BillState() As String
        Get 
            Return GetProperty(_billStateProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_billStateProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _billZipProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.BillZip)
    Public Property BillZip() As String
        Get 
            Return GetProperty(_billZipProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_billZipProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _billCountryProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.BillCountry)
    Public Property BillCountry() As String
        Get 
            Return GetProperty(_billCountryProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_billCountryProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _courierProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.Courier)
    Public Property Courier() As String
        Get 
            Return GetProperty(_courierProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_courierProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _totalPriceProperty As PropertyInfo(Of Decimal) = RegisterProperty(Of Decimal)(Function(p As Order) p.TotalPrice)
    Public Property TotalPrice() As Decimal
        Get 
            Return GetProperty(_totalPriceProperty)
        End Get
        Set (ByVal value As Decimal)
            SetProperty(_totalPriceProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _billToFirstNameProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.BillToFirstName)
    Public Property BillToFirstName() As String
        Get 
            Return GetProperty(_billToFirstNameProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_billToFirstNameProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _billToLastNameProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.BillToLastName)
    Public Property BillToLastName() As String
        Get 
            Return GetProperty(_billToLastNameProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_billToLastNameProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _shipToFirstNameProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.ShipToFirstName)
    Public Property ShipToFirstName() As String
        Get 
            Return GetProperty(_shipToFirstNameProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_shipToFirstNameProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _shipToLastNameProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.ShipToLastName)
    Public Property ShipToLastName() As String
        Get 
            Return GetProperty(_shipToLastNameProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_shipToLastNameProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _authorizationNumberProperty As PropertyInfo(Of Integer) = RegisterProperty(Of Integer)(Function(p As Order) p.AuthorizationNumber)
    Public Property AuthorizationNumber() As Integer
        Get 
            Return GetProperty(_authorizationNumberProperty)
        End Get
        Set (ByVal value As Integer)
            SetProperty(_authorizationNumberProperty, value)
        End Set
    End Property
    
    
    Private Shared ReadOnly _localeProperty As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(p As Order) p.Locale)
    Public Property Locale() As String
        Get 
            Return GetProperty(_localeProperty)
        End Get
        Set (ByVal value As String)
            SetProperty(_localeProperty, value)
        End Set
    End Property
    
    Private Shared ReadOnly _lineItemsProperty As PropertyInfo(Of LineItemList) = RegisterProperty(Of LineItemList)(Function(p As Order) p.LineItems, Csla.RelationshipTypes.LazyLoad)
    Public ReadOnly Property LineItems() As LineItemList 
        Get
            If Not (FieldManager.FieldExists(_lineItemsProperty)) Then
                If (Me.IsNew) Then
                    LoadProperty(_lineItemsProperty, LineItemList.NewList())
                Else
                    LoadProperty(_lineItemsProperty, LineItemList.GetByOrderId(OrderId))
                End If
            End If
            
            Return GetProperty(_lineItemsProperty) 
        End Get
    End Property
    
    Private Shared ReadOnly _orderStatusesProperty As PropertyInfo(Of OrderStatusList) = RegisterProperty(Of OrderStatusList)(Function(p As Order) p.OrderStatuses, Csla.RelationshipTypes.LazyLoad)
    Public ReadOnly Property OrderStatuses() As OrderStatusList 
        Get
            If Not (FieldManager.FieldExists(_orderStatusesProperty)) Then
                If (Me.IsNew) Then
                    LoadProperty(_orderStatusesProperty, OrderStatusList.NewList())
                Else
                    LoadProperty(_orderStatusesProperty, OrderStatusList.GetByOrderId(OrderId))
                End If
            End If
            
            Return GetProperty(_orderStatusesProperty) 
        End Get
    End Property
    
    #End Region
            
    #Region "Root Factory Methods"
    
    Public Shared Function NewOrder() As Order 
        Return DataPortal.Create(Of Order)()
    End Function
    
    Public Shared Function GetOrder(ByVal orderId As Integer) As Order         
        Return DataPortal.Fetch(Of Order)(New OrderCriteria(orderId))
    End Function

    Public Shared Sub DeleteOrder(ByVal orderId As Integer)
        DataPortal.Delete(New OrderCriteria(orderId))
    End Sub
    
    #End Region
    
    #Region "Child Factory Methods"
    
    Friend Shared Function NewOrderChild() As Order
        Return DataPortal.CreateChild(Of Order)()
    End Function
    
    Friend Shared Function GetOrderChild(ByVal orderId As Integer) As Order         
        Return DataPortal.FetchChild(Of Order)(New OrderCriteria(orderId))
    End Function

    #End Region
    

End Class